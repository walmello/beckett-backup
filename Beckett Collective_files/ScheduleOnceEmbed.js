if(!SOE){var IsSourceSOValidated=function(url){return/^(http:\/\/|https:\/\/)+([a-zA-Z0-9_+-]+\.){0,}(scheduleonce.com|meetme.so|booknow.so|bookme.so|staticso.com|staticso2.com|scheduleonce.net|onceplatform.com|oncehub.com)$/.test(url)};var TrimWhiteSpaces=function(element){if(element){var temp=element.value.trim();element.value="temp@value.com";element.value=temp}};var onIframeLoad=function(elem){if(elem)elem.style.display="block"};var receiveMessage=function(event){if(!IsSourceSOValidated(event.origin))return false;
var callSOAfterConfirmationFunction=false;var BookingKey="";var isDarkSystemTheme=false;if(event.data.newCustomerFront){setIframeProp(event.data.iframeId,function(iframe){var uarr=[];if(iframe&&iframe.src)uarr=iframe.src.toLowerCase().split("brdr=");if(uarr&&uarr.length>1){var brdr=uarr[1].split("&")[0];var optb=brdr.split("px");if(optb.length==1){optb=brdr.split("em");if(optb[0])optb[0]+="em"}else if(optb[0])optb[0]+="px";var wdthb=optb[0]!=undefined?optb[0]:0;var clrb=optb[1]!=undefined?optb[1]:
"000000";if(clrb.indexOf("rgb")==-1)clrb="#"+clrb;else clrb=clrb.replace(/%20/g," ");if(iframe)iframe.style.border=wdthb+" solid "+clrb}if(typeof soEmbedHeightChangeCallback=="function")soEmbedHeightChangeCallback(event.data)});callSOAfterConfirmationFunction=event.data.callSOAfterConfirmationFunction;if(event.data.iFrameLoaded)soe.setIframeOnloadEvent(event.data.newCustomerFront,event.data.iframeId);else if(callSOAfterConfirmationFunction){bookingData=event.data.bookingData;afterConfirmationHandlerFunc(bookingData,
event.data.newCustomerFront)}else if(event.data.scrollParent){var iframeElm=document.getElementById("SOI_"+event.data.iframeId);if(!soe.isIframePopupInViewport(iframeElm,event.data)){var pos=soe.isIframePopupInViewport(iframeElm,event.data,true);iframeElm.scrollIntoView(pos=="bottom"?false:true)}}else if(event.data.iFrameHeight)setIframeProp(event.data.iframeId,function(iframe){if(!event.data.isLoadScreen||["100%","auto"].indexOf(iframe.style.height)!=-1)iframe.style.height=event.data.iFrameHeight;
if(iframe&&!event.data.inLightBox&&event.data.isActiveFrame&&!event.data.noScrollToViewport&&!soe.isIframePopupInViewport(iframe,{}))(function(i){setTimeout(function(){iframe.scrollIntoView(true)})})(i)});else{var soInnerLightBox=document.getElementById("SOInnerLightBox");isDarkSystemTheme=event.data.isDarkSystemTheme;if(typeof event.data.isDarkSystemTheme!="undefined"&&soInnerLightBox&&soInnerLightBox.className.split(" ").indexOf("embedDark")==-1&&soInnerLightBox.className.split(" ").indexOf("embedLight")==
-1)if(isDarkSystemTheme)soInnerLightBox.className+=" embedDark";else soInnerLightBox.className+=" embedLight";if(typeof event.data.isDarkSystemTheme!="undefined"&&typeof event.data.iframeId!="undefined"){var isDarkTheme=event.data.isDarkSystemTheme;var iframe=document.getElementById("SOI_"+event.data.iframeId);if(iframe)iframe.setAttribute("sotheme",isDarkTheme?"dark":"light");var soic=document.getElementById("SOIC_"+event.data.iframeId);if(soic&&soic.style&&soic.style.backgroundPosition)soic.style.backgroundPosition=
isDarkTheme?"-39px -8px":"-9px -8px";soe.setblanketcolor(isDarkTheme)}}}else{var tmp=event.data.toString();if(tmp.indexOf("ScheduleOnceifrId")>-1){var ScheduleOnceifrId=null;var height=725;var recM=false;var mobileView=soe.isMobileView;eval(event.data);if(callSOAfterConfirmationFunction){if(tmp.indexOf("callSOAfterConfirmationFunction")>-1&&callSOAfterConfirmationFunction)afterConfirmationHandlerFunc(BookingKey)}else{height=isNaN(height)?725:height;if(ScheduleOnceifrId!=null){var id="SOI_"+ScheduleOnceifrId;
if(mobileView==true)height=height<280?280:height;var innerLightBoxHeight=height+40;var SOI_ele=document.querySelectorAll("[name*='ScheduleOnceIframe']");if(SOI_ele!=null&&SOI_ele.length>0)for(var i=0;i<SOI_ele.length;i++)if(SOI_ele[i].id==id){mobileView=SOI_ele[i].src.toLowerCase().indexOf("dt=0")>-1||soe.isMobileView;if(!recM&&!mobileView){if(SOI_ele[i].clientWidth<768)height=height<280?280:height;SOI_ele[i].height=height+"px";SOI_ele[i].style.height=height+"px";var SOI_lbEle=SOI_ele[i].parentElement.parentElement;
if(SOI_lbEle.id=="SOInnerLightBox")SOI_lbEle.style.height=innerLightBoxHeight+"px"}else if(recM&&mobileView||soe.isMobileView){SOI_ele[i].height=innerLightBoxHeight+"px";SOI_ele[i].style.height=innerLightBoxHeight+"px";if(!soe.isLive){var SOI_lbEle=SOI_ele[i].parentElement;SOI_lbEle.style.height=innerLightBoxHeight+"px"}}if(SOI_ele[i].src.toLowerCase().indexOf("em=1"))try{var uarr=SOI_ele[i].src.toLowerCase().split("brdr=");if(uarr.length>1){var brdr=uarr[1];var iamp=brdr.indexOf("&");if(iamp>0)brdr=
brdr.substr(0,iamp);var optb=brdr.split("px");var wdthb=optb[0]!=undefined?optb[0]:0;var clrb=optb[1]!=undefined?optb[1]:"000000";if(SOI_ele[i].contentWindow!=undefined){var box=SOI_ele[i].contentWindow.document.getElementById("BlueBox");box.style.border=wdthb+"px solid #"+clrb}}}catch(errb){console.log(errb.message)}}}}}}return};var setIframeProp=function(iframeId,cb){var id="SOI_"+iframeId;var SOI_ele=document.querySelectorAll('[id*="SOI_"]');if(SOI_ele!=null&&SOI_ele.length>0)for(var i=0;i<SOI_ele.length;i++)if(SOI_ele[i].id.toLowerCase()==
id.toLowerCase())cb(SOI_ele[i])};var afterConfirmationHandlerFunc=function(bookingDataOrKey,newCf){if(typeof SOAfterConfirmationFunction==="function")if(newCf)SOAfterConfirmationFunction(bookingDataOrKey);else{var xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){var data={};if(xhttp.readyState==4&&xhttp.status==200){data.errorStatus=0;data.bookingInfo=JSON.parse(xhttp.responseText.replace(/"/g,'"'));SOAfterConfirmationFunction(data)}else if(xhttp.status==404||xhttp.status==400||xhttp.status==
500){data.errorStatus=1;data.bookingInfo="{}";SOAfterConfirmationFunction(data)}};var url=soe.AppURL;xhttp.open("GET",url+"/GetMeetingInfoById?BookingKey="+bookingDataOrKey);xhttp.send()}};var checkDocumentLoaded=function(){return document.readyState==="complete"};var arrayContainsElement=function(array_elements,element){if(array_elements.length>0)for(var i=0;i<array_elements.length;i++)if(array_elements[i][0]==element)return i;return-1};var SOE=function(){this.bookingPos=1;this.emailPos=3;this.phonePos=
2;this.link;this.btLink;this.testLink;this.code="";this.bookingCode;this.emailCode;this.phoneCode;this.onclickProperty='onclick="soe.toggleDiv(';this.onclickProperty+="'SOWidgetContent','SOWidgetToggle')"+'"';this.phoneTitle;this.phoneText;this.phoneTextSep="_so_phone_sep_";this.emailTitle;this.emailBText;this.emailBTextColor="";this.emailBBGColor="";this.emailSendTo;this.emailAfter;this.emailAck="ScheduleOnce Mailer";this.emailCustTemplateId;this.emailUserTemplateId;this.bookingTitle;this.bookingBText;
this.bookingBBGColor;this.bookingBTextColor;this.widgetTitle;this.widgetColor;this.widgetBGColor;this.widgetLeft="left";this.eaid;this.pageName="";this.WidgetBoxStyle="z-index:997;text-align: left;font-family:Open Sans, sans-serif;bottom:0px; margin:0px;padding: 0px; width: 280px; font-size:14px; background-color: #FFF; -webkit-border-top-left-radius: 4px; -webkit-border-top-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px;-webkit-box-shadow: 0px 3px 25px 1px rgba(0,0,0,0.2);box-shadow: 0px 3px 25px 1px rgba(0,0,0,0.2)";
this.mWidgetBoxStyle="font-family:Open Sans, sans-serif;margin: 0px auto;z-index: 10000001;padding: 0px;width: 280px;background-color: #FFF;-webkit-box-shadow:0px 3px 25px 1px rgba(0,0,0,0.2);box-shadow:0px 3px 25px 1px rgba(0,0,0,0.2);opacity: 1;font-size:14px;top:2em;";this.widgetMeinHeadStyle="padding:0px; margin:0.8em auto;font-size:1em; color:#161616;  font-weight:bold;   display:block;  width:100%;";this.displayCount=3;this.postCode;this.isMobileView=false;this.isLive=true;this.divMobileTitle=
"";this.widgetHeadh5Style;this.noteValue="'Your note'";this.emailValue="'Your email'";this.emptyValue="''";this.isLightBox=false;this.calcWindowLeft=(this.getWindowWidth()-775)/2;this.winHeight="innerHeight"in window?window.innerHeight:document.documentElement.clientHeight;this.minWidthValue=775;this.URL="https://go.oncehub.com";this.StaticURL="https://cdn.oncehub.com";this.AppURL="https://app.oncehub.com/scheduleonce";this.CfURL="https://go.oncehub.com";this.isWidget=false;this.contactUsDiv="";this.prevTop=
0;this.prevLeft=0;this.prevHtml="";this.oldScreenCssPixelRatio=-1;this.runCode=false;this.isLandScape=false;this.devicepixelratio=1;this.screenwidth_td=null;this.screenwidth_swh=null;this.delayLoading=false;this.targetUrl=""};SOE.prototype.getBookingCode=function(isWidget){if(this.bookingPos!=-1){var bookingButtonStyle="background-color:"+(this.bookingBBGColor==""?"#FE9E0C":this.bookingBBGColor)+"; color:"+(this.bookingBTextColor==""?"#000000":this.bookingBTextColor)+"; cursor: pointer;font-size: 1em;font-weight: bold; margin: 0 auto; padding: 0em;width: 100%;text-align:center;line-height:3em;height:3em;";
this.bookingCode='<div id="SOBookingDiv" style="display:'+(this.bookingPos==0?"none":"block")+';padding:0 1.2858em 0 1.2858em; margin:0px 0px 1em 0px;"><div style="width:100%;;margin-bottom:0.45em;"><div style="float:left;margin-top:0px;width:100%;"><p style="'+this.widgetMeinHeadStyle.replace("margin:0.8em auto;","margin:"+(this.isMobileView?"1em auto 0 auto;":"0.345em auto;"))+'"> ';this.bookingCode+=this.bookingTitle+"</p></div>";this.bookingCode+='<div style="clear:both;"></div></div>';this.bookingCode+=
'<div style="padding:0px; margin:0px auto; width:100%;">';if(this.targetUrl!=undefined&&typeof this.targetUrl!="undefined"&&isWidget==true){if(!(this.targetUrl.includes("http")||this.targetUrl.includes("https")))this.targetUrl="http:"+this.targetUrl;this.bookingCode+="<div onclick=\"window.open('"+this.targetUrl+"','_self')\""}else this.bookingCode+='<div onclick="soe.toggleLightBox('+this.pageName+')"';this.bookingCode+='style = "text-decoration:none;" > <div id="SOBookingButton" style="'+bookingButtonStyle+
'">'+this.bookingBText+"</div></div></div></div>"}};SOE.prototype.setLightBoxCode=function(isParameterized,isScrollableIframe,height,openedThroughBtn,queryParam){var eleLB=document.getElementById("SOLightBox"+this.pageName.replace(/'/g,""));if(eleLB==null||eleLB==="undefined"){eleLB=document.createElement("div");eleLB.id="SOLightBox"+this.pageName.replace(/'/g,"");eleLB.Name="SOLightBox";eleLB.style.top="-10000px";eleLB.style.position="fixed";eleLB.style.padding="0";eleLB.style.margin="0";eleLB.style.width=
"100%";eleLB.innerHTML='<div id="SOInnerLightBox">'+this.getIframeHTMLCode(this.link,isParameterized,isScrollableIframe,height,openedThroughBtn,queryParam)+"</div>";var body=document.getElementsByTagName("body")[0];body.appendChild(eleLB)}};SOE.prototype.getEmailCode=function(){var emailButtonStyle="background-color:"+(this.emailBBGColor==""?"#fe9e0c":this.emailBBGColor)+";color:"+(this.emailBTextColor==""?"#000":this.emailBTextColor)+";margin:"+(this.isLive&&this.isMobileView?"0px 0px 0px 0;":"0px 0px 0px 0px;")+
"font-size: 1em; width: 33.3%;height:2em;line-height:2em; text-align:center; float:right;cursor:pointer;";this.emailCode='<div id="SOEmailDiv" style="display:'+(this.emailPos==0?"none":"block")+';padding:0 1.2858em 0 1.2858em; margin: 0 0 1em 0;"><p style="'+this.widgetMeinHeadStyle.replace("margin:0.8em auto","margin:0.1em auto 0.887em")+'">';this.emailCode+=this.emailTitle+'</p><div style="padding:0px; margin:0px auto 0px auto; width:100%;"><textarea id="SONote" onfocus="if(this.value=='+this.noteValue+
"){this.value="+this.emptyValue+'}" onblur="if(this.value=='+this.emptyValue+"){this.value="+this.noteValue+'} soe.onBlurText(this)" maxlength="200" name="" cols="" rows="" style="margin: 0px;min-height:34px; height:2.185em; border: 1px solid #d2d2d2; padding: 5px; width: 100%;color:#909090;font-size:0.9em;-webkit-border-radius: 0px; border-radius: 0px;font-family:Open Sans,sans-serif; box-sizing:border-box; -ms-box-sizing:border-box;" ></textarea>';this.emailCode+='<div id="SONoteErr" style="display:none;color:Red;font-size:0.857em; margin-bottom:0.7em">Note is a mandatory field</div><div style="margin-top:0.51em;width:100%;">';
this.emailCode+='<input id="SOSenderEmail" onfocus="if(this.value=='+this.emailValue+"){this.value="+this.emptyValue+'}" onblur="TrimWhiteSpaces(this);if(this.value=='+this.emptyValue+"){this.value="+this.emailValue+'} soe.onBlurText(this)" name="" type="email" value="'+this.emailValue.replace(/'/g,"")+'" style="margin: 0px; border: 1px solid #d2d2d2; padding: 0px 0px 0px 5px; height: 2.185em; width: 62.8%; color:#909090;font-size:0.9em;-webkit-border-radius: 0px; border-radius: 0px; height:2.18em; display: inline-block; box-sizing:border-box; -ms-box-sizing:border-box; font-family:Open Sans,sans-serif;" />';
this.emailCode+='<div id="SOEmailButton" onclick="soe.sendMail()" style="'+emailButtonStyle+'; box-sizing:border-box; -ms-box-sizing:border-box;">'+this.emailBText+"</div>";this.emailCode+='<div id="SOSenderEmailErr" style="display:none;color:Red; font-size:0.857em;line-height:1.7em">Email is a mandatory field</div></div></div></div>'};SOE.prototype.getPhoneCode=function(){this.phoneCode='<div id="SOPhoneDiv" style="display:'+(this.phonePos==0?"none":"block")+';padding:0 1.2858em 0 1.2858em; margin: 0 0px  0.63em  0px;"><div style="width:100%;"><div style="float:left;margin-top:0px;width:100%;"><p style="line-height:1.3em;'+
this.widgetMeinHeadStyle.replace("margin:0.8em auto;","margin:"+(this.isMobileView?"1em auto 0 auto;":"0.1em auto 0.767em auto;"))+'">'+this.phoneTitle+"</p>";var phoneArr=this.phoneText.split(this.phoneTextSep);for(var i=0;i<phoneArr.length;i++){var padding="0px";if(i>0)padding="0.2em 0 0 0";this.phoneCode+='<p style="padding:'+padding+'; margin:0px auto; width:100%;font-size:1.145em;line-height:1.378em;font-weight:normal;"><a style="'+(this.isMobileView?"color:#2466d1;text-decoration:underline;":
"color:#333333;text-decoration:none")+'" href="tel:'+(phoneArr[i].charAt(0)=="+"?"+":"")+phoneArr[i].replace(/\D/g,"")+'">'+phoneArr[i]+"</a></p>"}this.phoneCode+="</div>";if(this.bookingPos<1)this.phoneCode+="";this.phoneCode+='<div style="clear:both;height:0px;"></div></div></div>'};SOE.prototype.getWidgetCode=function(isScrollableIframe,widgetHeight,queryParam){var mCalcLeft=this.calcWindowLeft+250;var fontsizeOpenClose="22px";var mMarginTop="";var counterLeft="left";var topBottom="bottom";var mLeftValue=
"";var counterTopBottom="top";var mWidgetHeadStyle=(this.isLive?"position:fixed;width: 100%;bottom:0;left:0em; ":"position:absolute;width: 291px;bottom:33%;")+" padding: 0px;margin: 0px; height: 3.715em;font-family:'Open Sans', sans-serif;font-size:14px;-webkit-box-shadow: 0 -2px 4px 0 rgba(0,0,0,0.5);box-shadow: 0 -2px 4px 0 rgba(0,0,0,0.5);z-index: 10000;background-color:"+(this.widgetBGColor==""?"#333":this.widgetBGColor)+";";var openCloseHolderClass="padding: 0px; margin: 0px;width: 14px; height: 14px;line-height:14px;position: absolute;right: 12px;top:18px;  cursor: pointer; text-align: center;  font-family:Open Sans, sans-serif; color: #FFF;";
if(this.isMobileView){this.WidgetBoxStyle=this.WidgetBoxStyle.replace("-webkit-border-top-left-radius: 4px; -webkit-border-top-right-radius: 4px;border-top-left-radius: 4px; border-top-right-radius: 4px;","");if(!this.isLive)mMarginTop=this.widgetLeft=="left"?"margin-top:1.8em;":"margin-top:-0.6em;";else{mMarginTop=this.widgetLeft=="left"?"margin-top:1.3em;":"";openCloseHolderClass=openCloseHolderClass.replace("line-height:1.3em;","line-height:1.14em;")}this.mWidgetBoxStyle+=this.isLive?"left:"+mCalcLeft+
"px;":"left:26%;"}else this.WidgetBoxStyle=this.WidgetBoxStyle.replace("-webkit-border-radius:4px; border-radius: 4px;","");var widgetHeadStyle="bottom:0;padding: 0px;margin: 0px; width: 100%; height: 3.715em; position: relative;";this.widgetHeadh5Style="padding-left:1.15em; margin:0px;font-size:1.0715em;  font-weight:bold;line-height:3.345em;text-transform: none;letter-spacing: 0px;border-top-width:0;";var orHolderStyle="padding: 1em 0px 0px 0px; margin: 0px 0px -0.489em 0px; width: 100%;height: 1.8em;box-sizing:content-box !important;-webkit-box-sizing:content-box !important;-ms-box-sizing:content-box !important;";
var orLineStyle="padding: 0; margin:0;/*height: 0.09em;background-color: #424242;*/border-bottom:0.09em solid #CACACA; position: relative;";var orDivStyle="padding: 0;margin: 0;width: 1.8em;  height: 1.8em; background-color: #FFF;text-align: center;position: absolute; left: 46%;  top: -0.85em;";var orPStyle="padding: 0;margin: 0px;color: #CACACA; font-size: 0.9em; line-height: 1.8em; width:100%;";var powerDivDesktop="padding:0px; margin:0px;  text-align:center; font-size:0.786em; color:#666666;line-height:1.9em;";
var closeWidgetStyle="padding:0px;margin:0.5em 5% 0 0;width:25%; height:1.8em; border:solid 1px #747474; text-align:center;float:right; font-size:0.857em;color:#000;text-decoration:none; line-height:1.8em;background: #eaeaea; /* Old browsers */ background: -moz-linear-gradient(top,  #eaeaea 1%, #919191 100%); /* FF3.6+ */ background: -webkit-gradient(linear, left top, left bottom, color-stop(1%,#eaeaea), color-stop(100%,#919191)); /* Chrome,Safari4+ */ background: -webkit-linear-gradient(top,  #eaeaea 1%,#919191 100%); /* Chrome10+,Safari5.1+ */ background: -o-linear-gradient(top,  #eaeaea 1%,#919191 100%); /* Opera 11.10+ */ background: -ms-linear-gradient(top,  #eaeaea 1%,#919191 100%); /* IE10+ */ background: linear-gradient(to bottom,  #eaeaea 1%,#919191 100%); /* W3C */ filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#eaeaea', endColorstr='#919191',GradientType=0 ); /* IE6-9 */-webkit-border-radius: 4px; border-radius: 4px;";
var orEnd='<div style="'+orLineStyle+'"><div style="'+orDivStyle+'"><p style="'+orPStyle+'">or</p></div></div></div>';var or1='<div style="display:'+(this.displayCount==1?"none":"block")+";"+orHolderStyle+'" >'+orEnd;var or2='<div style="display:'+(this.displayCount==2||this.displayCount==1?"none":"block")+";"+orHolderStyle+'">'+orEnd;var imagelink=this.StaticURL+"/images/widgetPlusWhite.png";if(this.widgetColor=="rgb(255, 255, 255)"||this.widgetColor=="#ffffff"||this.widgetColor=="")imagelink=this.StaticURL+
"/images/widgetPlusWhite.png";else imagelink=this.StaticURL+"/images/widgetPlusDark.png";this.code='<a href="javascript:void(1);" '+this.onclickProperty+' style="text-decoration:none;"><div id="SOWidgetTitle" style="'+widgetHeadStyle+"background-color:"+(this.widgetBGColor==""?"#333":this.widgetBGColor)+';"><span style="color:'+(this.widgetColor==""?"#fff":this.widgetColor)+";"+this.widgetHeadh5Style+'">'+this.widgetTitle+'</span><div id="SOWidgetToggle" style="'+openCloseHolderClass+'" ><img src="'+
imagelink+'"  style="width:12px; height:12px;" /></div></div></a>';this.code+='<div id="SOWidgetContent" style="height:100%;display:none;margin-top:1.154em;box-sizing:border-box; padding-bottom:1em">';this.contactUsDiv='<div style="border-top:1px solid #fff;color:'+(this.widgetColor==""?"#fff":this.widgetColor)+";"+this.widgetHeadh5Style+'">'+this.widgetTitle+'</div><div style="'+openCloseHolderClass+'" ><img src="'+imagelink+'"  style="width:12px; height:12px;" /></div>';if(!this.isLive)this.divMobileTitle=
'<div id="mSOWidgetTitle" style="/*'+this.widgetLeft+":-14%;*/"+mWidgetHeadStyle+'display:none;letter-spacing:1px;" '+this.onclickProperty+">"+this.contactUsDiv+" </div>";else this.divMobileTitle=mLeftValue+mWidgetHeadStyle+'display:none;"';if(this.bookingPos==1)this.code+=this.bookingCode+or1;if(this.emailPos==1)this.code+=this.emailCode+or1;if(this.phonePos==1)this.code+=this.phoneCode+or1;if(this.bookingPos==2)this.code+=this.bookingCode+or2;if(this.emailPos==2)this.code+=this.emailCode+or2;if(this.phonePos==
2)this.code+=this.phoneCode+or2;if(this.bookingPos==3||this.bookingPos==0)this.code+=this.bookingCode;if(this.emailPos==3||this.emailPos==0)this.code+=this.emailCode;if(this.phonePos==3||this.phonePos==0)this.code+=this.phoneCode;if(this.targetUrl==undefined||typeof this.targetUrl=="undefined"||this.targetUrl==null||this.targetUrl=="")this.setLightBoxCode("",isScrollableIframe,widgetHeight,false,queryParam)};SOE.prototype.setWidgetHTML=function(isScrollableIframe,widgetHeight,queryParam){this.getBookingCode(true);
this.getEmailCode();this.getPhoneCode();this.getWidgetCode(isScrollableIframe,widgetHeight,queryParam);var ele=document.getElementById("SOWidget");if(ele==null||ele==="undefined"){ele=document.createElement("div");ele.id="SOWidget"}var body=document.getElementsByTagName("body")[0];body.appendChild(ele);if(soe.getIEVersion()<9)try{this.isMobileView?ele.style.position="absolute":ele.style.position="fixed";if(this.widgetLeft=="left")ele.style.left="90px";else ele.style.right="90px";ele.style.fontSize=
"14px";ele.style.zIndex="10000";ele.style.fontFamily="Tahoma, HelveticaNeue, Arial";ele.style.padding="0px";ele.style.width="260px";ele.style.border="solid 1px Gray";ele.style.backgroundColor="#FFF";if(this.isMobileView){ele.style.margin="0px auto";ele.style.top="2em";ele.style.opacity="1"}else{ele.style.textAlign="left";ele.style.margin="0px";ele.style.bottom="0px"}}catch(ex){}else ele.setAttribute("style",(this.isMobileView?"position:absolute;":"position:fixed;"+this.widgetLeft+":90px;")+(this.isMobileView?
this.mWidgetBoxStyle:this.WidgetBoxStyle));if(this.isMobileView){ele.innerHTML=this.code;var bgEle=document.createElement("div");bgEle.id="SoWidgetBackground";bgEle.setAttribute("style","position:fixed;top:0px;right:0px;bottom:0px;left:0px;background-color:black;opacity:0.4;display:none;z-index:10000");body.insertBefore(bgEle,ele);bgEle=document.createElement("div");if(this.isLive){bgEle.id="mSOWidgetTitle";bgEle.setAttribute("style",this.divMobileTitle);bgEle.setAttribute("onclick",this.onclickProperty.replace("onclick=",
"").replace(/"/g,""));bgEle.innerHTML=this.contactUsDiv;body.insertBefore(bgEle,ele);bgEle=document.createElement("div");bgEle.id="SOmarginDivForMobile";bgEle.innerHTML="&nbsp;";bgEle.setAttribute("style","height:4em;");body.appendChild(bgEle)}this.setStyl("SOWidgetTitle","display","none");this.setStyl("mSOWidgetTitle","display","block");this.setStyl("SODesktopPower","display","none");this.setStyl("SOWidget",{display:"none",width:"80%",left:"10%"});setTimeout(function(){soe.processOrientationChange(true)},
200)}else ele.innerHTML=this.code;document.getElementById("SONote").value=soe.noteValue.replace(/'/g,"");this.TransitionCode(ele)};SOE.prototype.setButtonHTML=function(isParameterized,isScrollableIframe,height,openedThroughBtn,queryParam){this.getBookingCode(false);var elemID="SOLightBox"+this.pageName.replace(/'/g,"");var elem=document.getElementById(elemID);if(elem)elem.parentNode.removeChild(elem);this.setLightBoxCode(isParameterized,isScrollableIframe,height,openedThroughBtn,queryParam)};SOE.prototype.toggleDiv=
function(id,obj,hideOnly){var elem=document.getElementById(id);if(elem){var widgetDiv=id=="SOWidgetContent"?true:false;if((elem.style.display=="none"||elem.style.display==""||elem.style.display=="undefined")&&hideOnly==null){elem.style.display="block";if(widgetDiv){if(this.isMobileView){document.getElementById("mSOWidgetTitle").style.display="none";document.getElementById("SOWidgetTitle").style.display="block";document.getElementById("SOWidget").style.display="block";if(this.isLive){document.getElementById("SoWidgetBackground").style.display=
"block";window.scrollTo(0,0)}}if(obj!=null){var imagelink=this.StaticURL+"/images/widgetCloseWhite.png";if(this.widgetColor=="rgb(255, 255, 255)"||this.widgetColor=="#ffffff"||this.widgetColor=="")imagelink=this.StaticURL+"/images/widgetCloseWhite.png";else imagelink=this.StaticURL+"/images/widgetCloseDark.png";document.getElementById(obj).innerHTML='<img src="'+imagelink+'" style="width:14px; height:14px;">'}}}else{elem.style.display="none";if(widgetDiv){if(this.isMobileView){document.getElementById("SOWidgetTitle").style.display=
"none";document.getElementById("mSOWidgetTitle").style.display="block";document.getElementById("SOWidget").style.display="none";if(this.isLive)document.getElementById("SoWidgetBackground").style.display="none";else document.getElementById("mSOWidgetTitle").style.bottom="0%"}if(!this.isLightBox&&!this.isMobileView)this.TransitionCode(document.getElementById("SOWidget"));if(this.prevHtml!="")document.getElementById("SOWidgetContent").innerHTML=this.prevHtml}if(obj!=null){var imagelink=this.StaticURL+
"/images/widgetPlusWhite.png";if(this.widgetColor=="rgb(255, 255, 255)"||this.widgetColor=="#ffffff"||this.widgetColor=="")imagelink=this.StaticURL+"/images/widgetPlusWhite.png";else imagelink=this.StaticURL+"/images/widgetPlusDark.png";document.getElementById(obj).innerHTML='<img src="'+imagelink+'" style="width:14px; height:14px;">';var soWidgetDiv=document.getElementById("SOWidget");if(soWidgetDiv)soWidgetDiv.setAttribute("sending-mail","false")}}}};SOE.prototype.setblanketcolor=function(isDarkTheme){var b=
document.getElementById("SOBlanket");var c=isDarkTheme?"#ffffff":"#000000";var o=isDarkTheme?"0.8":"0.6";if(b&&b.style){if(typeof b.style.backgroundColor!="undefined")b.style.backgroundColor=c;if(typeof b.style.opacity!="undefined")b.style.opacity=o}};SOE.prototype.toggleLightBox=function(page){var ieversion=soe.getIEVersion();if(this.isMobileView||ieversion<9){var ele=document.getElementById("SOI_"+page);if(ele)if(ele.getAttribute("data-mysrc")&&this.delayLoading)window.open(ele.src=ele.getAttribute("data-mysrc").replace("em=1",
"bt=1"));else window.open(ele.src.replace("em=1","bt=1"));else{var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe_"+page+"']");for(i=0;i<allIfrm.length;i++){ele=allIfrm[i];if(ele.getAttribute("data-mysrc")&&ele){if(ele.getAttribute("data-mysrc")&&this.delayLoading)window.open(ele.src=ele.getAttribute("data-mysrc").replace("em=1","bt=1"));else window.open(ele.src.replace("em=1","bt=1"));break}}}}else{var divStyle;var id="SOLightBox"+page;var div=document.getElementById(id);var node=
document.getElementsByTagName("body")[0];var frame=document.getElementById("SOI_"+page);if(frame===null)frame=document.querySelector("[id^=SOI_"+page+"][data-mysrc]");if(this.delayLoading||frame==null||frame.src==null||frame.src==window.location.href)soe.setIframeSrc();if(soe.isLive&&frame&&frame.src&&frame.src.indexOf("isSoLightBoxOpen")===-1)frame.src=frame.src+"#isSoLightBoxOpen="+true;var blanketTop=0;var blueBox=document.getElementById("BlueBox");if(blueBox!=null)blueBox.style.minWidth="769px";
if(div.style.top.indexOf("-10000px")>-1){var blanket=document.getElementById("SOBlanket");if(blanket==null||blanket=="undefined"){blanket=document.createElement("div");blanket.id="SOBlanket";node.appendChild(blanket)}node.style.overflow="hidden";this.isLightBox=true;this.toggleDiv("SOWidgetContent","SOWidgetToggle",true);if(ieversion>=9){var blanketStyle="height:100%; width:100%; left:0px;z-index:100000000;position:fixed;background-color:black;opacity:0.6;filter:alpha(opacity=60);top:0px;";blanket.setAttribute("style",
blanketStyle)}else{blanket.style.height="100%";blanket.style.width="100%";blanket.style.left="0px";blanket.style.zIndex="100000000";blanket.style.position="fixed";blanket.style.backgroundColor="black";blanket.style.opacity="0.6";blanket.style.filter="alpha(opacity=60)";blanket.style.top="0px"}if(frame&&frame.getAttribute){var sotheme=frame.getAttribute("sotheme");soe.setblanketcolor(sotheme=="dark")}this.toggleDiv("SOBlanket",null);blanketTop=blanketTop+5;var _width=this.getWindowWidth()-this.calcWindowLeft;
_width=(_width<this.minWidthValue?this.minWidthValue:_width)+"px";if(ieversion>=9){divStyle="height:100%;display:block;left:"+"0px;top:"+blanketTop+"px;width:"+"100%;z-index:10000000001;position:fixed;overflow-y:auto;";div.setAttribute("style",divStyle)}else{div.style.height="100%";div.style.display="block";div.style.left=this.calcWindowLeft+"px";div.style.top=blanketTop+"px";div.style.width=_width;div.style.zIndex="10000000001";div.style.position="fixed";div.style.overflowY="auto"}var childEle=null;
var childArr=div.children;for(var i=0;i<childArr.length;i++)if(childArr[i].id=="SOInnerLightBox"){childEle=childArr[i];break}var height="height:"+(childEle!=null&&childEle.style&&childEle.style.height?childEle.style.height:"");var topVal="top:15px;";if(ieversion>=9){divStyle=divStyle.replace("width:"+"100%;z-index:10000000001;position:fixed;overflow-y:auto","width:775px; max-width: 90%;"+topVal).replace("height:100%",height)+"position:relative;margin:0 auto;";divStyle=divStyle.replace("display:block;left:"+
"0px;top:"+blanketTop+"px;","");childEle.setAttribute("style",divStyle)}else{childEle.style.width=_width;childEle.style.zIndex="10000000001";childEle.style.position="fixed";childEle.style.overflowY="auto";childEle.style.width="775px";childEle.style.top="15px";childEle.style.height=childEle!=null&&childEle.style&&childEle.style.height?childEle.style.height:"";childEle.style.position="absolute";childEle.style.display="block";childEle.style.top=blanketTop+"px"}if(!soe.isLive){document.getElementById("whiteDiv").style.zIndex=
"9999";document.getElementById("prevDiv").style.zIndex="9999"}}else{this.toggleDiv("SOBlanket",null);node.style.overflow="auto";this.isLightBox=false;div.style.top="-10000px";if(!soe.isLive){document.getElementById("whiteDiv").style.zIndex="10000002";document.getElementById("prevDiv").style.zIndex="10000002"}}}return false};SOE.prototype.getIframeHTMLCode=function(_pageLink,isParameterized,isScrollableIframe,height,openedThroughBtn,queryParam){var h=isScrollableIframe?height?height:"620px":"100%";
var w="90%";var minWidth="0px";var ver="";var style="border:solid 3px #FFF;background-color:#FFF;";var scrollingEnable=isScrollableIframe?"yes":"no";var rightMargin=isScrollableIframe?-23:-23;var pre='<span id="SOIC_'+this.pageName.replace(/'/g,"")+'" onclick="soe.toggleLightBox('+this.pageName+')" style="position: absolute; top: -1px; right:'+rightMargin+"px; width: 16px; height: 16px; z-index: 1000; background-size: 74px 36px;background-repeat: no-repeat; background-position: -9px -8px; background-image: url("+
this.StaticURL+'/images/ncf_Lightbox@2x.png); background-color: transparent; cursor: pointer;"></span>';var post="";if(!this.isMobileView){h=isScrollableIframe?height?height:"620px":"auto";w="100%";minWidth="769px";ver="";style="width:"+w+";height:"+h+";min-width:"+minWidth+";"+style;post="</div>"}var src=_pageLink+(_pageLink.indexOf("?")==-1?"?":"&")+"dt="+ver+"&em=1&Lightbox=1"+queryParam;src=openedThroughBtn?src+"&openedThroughBtn=1":src;if(isScrollableIframe)src+="&Si=1";var iframesrc="";var mysrc=
"";if(this.isLive)mysrc=src;else iframesrc=src;var _code=pre+'<iframe src="'+iframesrc+'" id="SOI_'+this.pageName.replace(/'/g,"")+'" name="ScheduleOnceIframe" data-mysrc="'+mysrc+'" scrolling="'+scrollingEnable+'" frameborder="0" hspace="0" marginheight="0" marginwidth="0" height="'+h+'" width="'+w+'" vspace="0" style="'+style+'"></iframe>'+post;return _code};SOE.prototype.getUrlParameters=function(){var ret="p="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedPosition))+"&wt="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedWidgetTitle))+
"&wc="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedWidgetColor))+"&wb="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedWidgetBGColor))+"&wl="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedWidgetLeft))+"&pt="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedPhoneTitle))+"&pn="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedPhoneText))+"&et="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailTitle))+"&ebt="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailBText))+
"&ebtc="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailBTextColor))+"&ebcc="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailBBGColor))+"&est="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailSendTo))+"&ea="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailAck))+"&eaf="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedEmailAfter))+"&ect="+encodeURIComponent(this.encodeToHTML(typeof ScheduleOnceEmbedEmailCustTemp=="undefined"?0:ScheduleOnceEmbedEmailCustTemp))+
"&eut="+encodeURIComponent(this.encodeToHTML(typeof ScheduleOnceEmbedEmailUserTemp=="undefined"?0:ScheduleOnceEmbedEmailUserTemp))+"&bt="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedBookingTitle))+"&bbt="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedBookingBText))+"&bbtc="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedBookingBTextColor))+"&ebbc="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedBookingBBGColor))+"&l="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedLink))+
"&pgn="+encodeURIComponent(this.encodeToHTML(ScheduleOnceEmbedPageName))+"&eaid="+encodeURIComponent(this.encodeToHTML(typeof ScheduleOnceEmbedAid=="undefined"?"":ScheduleOnceEmbedAid));return ret};SOE.prototype.encodeToHTML=function(str,removeLines){if(str){if(removeLines)str=str.replace(/\r/g,"").replace(/\n/g,"line_break_placeHolder");str=str.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return str};SOE.prototype.fixLines=
function(str){return str.replace(/line_break_placeHolder/g,"<br />")};SOE.prototype.decodeToHTML=function(str){if(str)str=str.replace(/&amp;/g,"&").replace(/&#92;/g,"\\").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&gt;/g,">").replace(/&lt;/g,"<");return str};SOE.prototype.sendMail=function(){var uri=this.AppURL+"/webservice/MailSendEmbed.asmx/SendMailRequest";var validate=true;var from=document.getElementById("SOSenderEmail").value;var message=document.getElementById("SONote").value;if(!from>
0){document.getElementById("SOSenderEmailErr").style.display="block";document.getElementById("SOSenderEmailErr").innerText="Email is a mandatory field";validate=false}else if(!this.ValidateEmail(from)){document.getElementById("SOSenderEmailErr").style.display="block";document.getElementById("SOSenderEmailErr").innerText="Please enter a valid email";validate=false}if(!this.ValidateQuery(message)){document.getElementById("SONoteErr").style.display="block";validate=false}if(validate){var soWidgetDiv=
document.getElementById("SOWidget");if(soWidgetDiv)if(soWidgetDiv.getAttribute("sending-mail")=="true")return;else soWidgetDiv.setAttribute("sending-mail","true");var data="ST|||TO="+this.emailSendTo+"|||FROM="+from+"|||MSG="+message+"|||EMAILLABEL="+soe.decodeToHTML(this.emailAck)+"|||AID="+this.eaid+"|||CTID="+this.emailCustTemplateId+"|||UTID="+this.emailUserTemplateId+"|||BP="+this.pageName+"|||ED";var xmlHttp=this.createRequestObject();uri+="?data="+encodeURIComponent(this.encodeToHTML(data,
true));try{if(soe.getIEVersion()<9)if(uri.indexOf("https://")>-1&&document.URL.toLowerCase().indexOf("https://")<0)uri=uri.replace("https://","http://");else if(uri.indexOf("https://")<0&&document.URL.toLowerCase().indexOf("https://")>-1)uri=uri.replace("http://","https://");xmlHttp.open("GET",uri,true);xmlHttp.send()}catch(ex){if((ex.message=="Access is denied.\r\n"||ex.message=="Permission denied")&&soe.getIEVersion()<9)alert("This function is not supported by your browser");return}var soWidgetCont=
document.getElementById("SOWidgetContent");var height=-1;if(soWidgetCont){this.prevHtml=soWidgetCont.innerHTML;if(soWidgetCont.clientHeight)height=soWidgetCont.clientHeight}else this.prevHtml="";if(height<0)height=352;var html='<div style="min-height:'+(height-20)+'px;width:205px; word-wrap:break-word;font-size:14px;color:#333333;padding-left:14px;"><p style="width:100%;line-height:130%;">'+this.emailAfter+"</p></div>"+(this.postCode?this.postCode:"");if(this.isMobileView){document.body.scrollTop=
0;html='<div style="min-height:'+(height-20)+'px;width:75%; word-wrap:break-word;font-size:1.2em;color:#333333;padding-left:14px;"><p style="width:100%;line-height:130%;">'+this.emailAfter+"</p></div>"+(this.postCode?this.postCode.replace('<div id="SODesktopPower"style="display:none;','<div id="SODesktopPower"style="display:none;"'):"")}if(soWidgetCont)soWidgetCont.innerHTML=html;if(this.isMobileView)document.body.scrollTop=0}};SOE.prototype.createRequestObject=function(){if(window.XMLHttpRequest)return xmlhttprequest=
new XMLHttpRequest;else if(window.ActiveXObject)return xmlhttprequest=new ActiveXObject("Microsoft.XMLHTTP")};SOE.prototype.onBlurText=function(obj){if(obj.id=="SONote")if(this.ValidateQuery(obj.value)){document.getElementById("SONoteErr").style.display="none";obj.style.color="#161616"}else{obj.style.color="#666666";document.getElementById("SONoteErr").style.display="block"}else if(obj.id=="SOSenderEmail")if(!obj.value>0||obj.value==this.emailValue.replace(/'/g,"")){obj.style.color="#666666";document.getElementById("SOSenderEmailErr").style.display=
"block";document.getElementById("SOSenderEmailErr").innerText="Email is a mandatory field"}else if(!this.ValidateEmail(obj.value)){obj.style.color="#666666";document.getElementById("SOSenderEmailErr").style.display="block";document.getElementById("SOSenderEmailErr").innerText="Please enter a valid email"}else{document.getElementById("SOSenderEmailErr").style.display="none";obj.style.color="#161616"}};SOE.prototype.ValidateEmail=function(email){if(email&&email.length>0){if(!this.ValidateChars(email))return false;
if(email.indexOf("@")<1)return false;else if(email.split("@").length>2)return false;else if(email.lastIndexOf(".")<=email.indexOf("@"))return false;else if(Math.max(email.indexOf("+"),email.indexOf("~"))>=email.indexOf("@"))return false;else if(email.indexOf("@")==email.length)return false;else if(email.indexOf("..")>=0)return false;else if(email.charAt(email.length-1).indexOf(".")>=0||email.indexOf(".")==0)return false;return true}else return false};SOE.prototype.ValidateChars=function(email){var parsed=
true;var validMailchars="abcdefghijklmnopqrstuvwxyz0123456789@.-_+~";for(var i=0;i<email.length;i++){var letter=email.charAt(i).toLowerCase();if(validMailchars.indexOf(letter)!=-1)continue;parsed=false;break}return parsed};SOE.prototype.ValidateQuery=function(query){if(query.length<1||query=="Your note"){document.getElementById("SONoteErr").innerText="Note is a mandatory field";return false}else if(query.length>200){document.getElementById("SONoteErr").innerText="Maximum 200 characters allowed";return false}else return true};
SOE.prototype.getWindowWidth=function(){var n_win=window.innerWidth?window.innerWidth:0;var n_docel=document.documentElement?document.documentElement.clientWidth:0;var n_result=n_win?n_win:0;return n_docel&&(!n_result||n_result>n_docel)?n_docel:n_result};var soe=new SOE;SOE.prototype.TransitionCode=function(element){if(element==null&&this.isMobileView)return;var original=parseInt(element.style.bottom.replace("%",""));var number=original-30;element.style.bottom=number+"%";setTimeout(function(){soe.animateToTransition(number+
1,element,original)},33)};SOE.prototype.animateToTransition=function(newValue,element,original){if(newValue<original){element.style.bottom=newValue+"%";setTimeout(function(){soe.animateToTransition(newValue+1,element,original)},33)}else element.style.bottom=original+"%"};SOE.prototype.processOrientationChange=function(updateWidth){soe.setIframeSrc();var _width=soe.getWindowWidth();soe.calcWindowLeft=(_width-775)/2;_width=_width-soe.calcWindowLeft;if(!soe.isMobileView){soe.calcWindowLeft=soe.calcWindowLeft<
0?0:soe.calcWindowLeft;_width=(_width<soe.minWidthValue?soe.minWidthValue:_width)+"px";var f=document.querySelectorAll("*[id*='SOLightBox']");for(var i=0;i<f.length;i++){f[i].style.left=soe.calcWindowLeft+"px";f[i].style.width=_width}}else if(soe.isLive){var ele=document.getElementById("SOWidget");if(ele){var _screenWidth=screen.width;var isLandScape=window.orientation==90||window.orientation==-90;var _windowInnerWidth=window.innerWidth;var screenCssPixelRatio=1;var setMultiplier=false;var setDivider=
false;if(window.outerWidth>0&&_windowInnerWidth>0)screenCssPixelRatio=(window.outerWidth-8)/_windowInnerWidth;if(_windowInnerWidth>_screenWidth)setMultiplier=true;else if(_windowInnerWidth<_screenWidth)setDivider=true;var _width=.8*_windowInnerWidth;ele.style.width=_width+"px";var mCalcFont=14;var ceil=_windowInnerWidth==_screenWidth?null:Math.ceil(screenCssPixelRatio);ceil=navigator.userAgent.match(/Windows Phone/i)?null:ceil;if(_screenWidth<=320){if(ceil!=null){mCalcFont=14;if(!isLandScape)if(ceil<
2)mCalcFont=35;else if(ceil<=4&&ceil>=2)mCalcFont=18;else if(ceil>8&&ceil<=13)mCalcFont=9;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*2.5;mCalcFont=mCalcFont<14?14:mCalcFont>18?18:mCalcFont}else{if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>14?14:mCalcFont<12?12:mCalcFont}}else if(ceil<2)mCalcFont=20;else if(ceil<4&&ceil>1)mCalcFont=
16;else if(ceil>8&&ceil<=13)mCalcFont=6;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*1.5;mCalcFont=mCalcFont<14?14:mCalcFont>16?16:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>11?11:mCalcFont<7?7:mCalcFont}}}else if(_screenWidth>320&&_screenWidth<=480){mCalcFont=15;if(ceil!=null)if(!isLandScape)if(ceil>1&&ceil<2)mCalcFont=
30;else if(ceil<4&&ceil>1)mCalcFont=17;else if(ceil>8&&ceil<=13)mCalcFont=6;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*1.5;mCalcFont=mCalcFont<15?15:mCalcFont>17?17:mCalcFont}else{if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>11?11:mCalcFont<7?7:mCalcFont}}else{if(ceil<3&&ceil>1)mCalcFont=17;if(ceil>5&&ceil<=9)mCalcFont=5;else if(ceil>
9)mCalcFont=4;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<14?14:mCalcFont>17?17:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>10?10:mCalcFont<4?4:mCalcFont}}}else if(_screenWidth>480&&_screenWidth<=800){mCalcFont=19;if(ceil!=null)if(!isLandScape){if(ceil<3&&ceil>1)mCalcFont=24;if(ceil>5&&ceil<=9)mCalcFont=6;else if(ceil>9)mCalcFont=
4;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<19?19:mCalcFont>21?21:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>11?11:mCalcFont<5?5:mCalcFont}}else{if(ceil<3&&ceil>1)mCalcFont=14;if(ceil>5&&ceil<=9)mCalcFont=4;else if(ceil>9)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<17?17:
mCalcFont>20?20:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>10?10:mCalcFont<5?5:mCalcFont}}}if(updateWidth){ele.style.fontSize=mCalcFont+"px";document.getElementById("mSOWidgetTitle").style.fontSize=mCalcFont+"px"}}}};SOE.prototype.orientationChange=function(){setTimeout(function(){soe.processOrientationChange(false)},200)};SOE.prototype.zoomChange=function(){var ele=
document.getElementById("SOWidget");if(ele){var _screenWidth=screen.width;var isLandScape=window.orientation==90||window.orientation==-90;var _windowInnerWidth=window.innerWidth;var screenCssPixelRatio=1;var setMultiplier=false;var setDivider=false;if(window.outerWidth>0&&_windowInnerWidth>0)screenCssPixelRatio=(window.outerWidth-8)/_windowInnerWidth;if(_windowInnerWidth>_screenWidth)setMultiplier=true;else if(_windowInnerWidth<_screenWidth)setDivider=true;var mCalcFont=14;if(soe.runCode&&soe.oldScreenCssPixelRatio!=
screenCssPixelRatio){soe.oldScreenCssPixelRatio=screenCssPixelRatio;var ceil=_windowInnerWidth==_screenWidth?null:Math.ceil(screenCssPixelRatio);var _width=.8*_windowInnerWidth;ele.style.width=_width+"px";if(_screenWidth<=320){if(ceil!=null){mCalcFont=14;if(!isLandScape)if(ceil<2)mCalcFont=35;else if(ceil<=4&&ceil>=2)mCalcFont=18;else if(ceil>8&&ceil<=13)mCalcFont=9;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*2.5;mCalcFont=mCalcFont<14?14:mCalcFont>18?
18:mCalcFont}else{if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>14?14:mCalcFont<12?12:mCalcFont}}else if(ceil<2)mCalcFont=20;else if(ceil<4&&ceil>1)mCalcFont=16;else if(ceil>8&&ceil<=13)mCalcFont=6;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*1.5;mCalcFont=mCalcFont<14?14:mCalcFont>16?16:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*
(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>11?11:mCalcFont<7?7:mCalcFont}}}else if(_screenWidth>320&&_screenWidth<=480){mCalcFont=15;if(ceil!=null)if(!isLandScape)if(ceil<2)mCalcFont=30;else if(ceil<4&&ceil>1)mCalcFont=17;else if(ceil>8&&ceil<=13)mCalcFont=6;else if(ceil>13)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio*1.5;mCalcFont=mCalcFont<15?15:mCalcFont>17?17:mCalcFont}else{if(setDivider){mCalcFont=
Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>11?11:mCalcFont<7?7:mCalcFont}}else{if(ceil<3&&ceil>1)mCalcFont=17;if(ceil>5&&ceil<=9)mCalcFont=5;else if(ceil>9)mCalcFont=4;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<14?14:mCalcFont>17?17:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):
screenCssPixelRatio));mCalcFont=mCalcFont>10?10:mCalcFont<4?4:mCalcFont}}}else if(_screenWidth>480&&_screenWidth<=800){mCalcFont=19;if(ceil!=null)if(!isLandScape){if(ceil<3&&ceil>1)mCalcFont=24;if(ceil>5&&ceil<=9)mCalcFont=6;else if(ceil>9)mCalcFont=4;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<19?19:mCalcFont>21?21:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));
mCalcFont=mCalcFont>11?11:mCalcFont<5?5:mCalcFont}}else{if(ceil<3&&ceil>1)mCalcFont=14;if(ceil>5&&ceil<=9)mCalcFont=4;else if(ceil>9)mCalcFont=3;else if(setMultiplier){mCalcFont=mCalcFont*screenCssPixelRatio;mCalcFont=mCalcFont<17?17:mCalcFont>20?20:mCalcFont}else if(setDivider){mCalcFont=Math.round(mCalcFont*(screenCssPixelRatio>=4.5?screenCssPixelRatio-Math.floor(screenCssPixelRatio):screenCssPixelRatio));mCalcFont=mCalcFont>10?10:mCalcFont<5?5:mCalcFont}}}ele.style.fontSize=mCalcFont+"px";document.getElementById("mSOWidgetTitle").style.fontSize=
mCalcFont+"px"}}};{(function(){if(document.querySelectorAll||document.querySelector)return;var style=document.createStyleSheet(),select=function(selector,maxCount){var all=document.all,l=all.length,i,resultSet=[];style.addRule(selector,"*[id*='SOLightBox']");for(i=0;i<l;i+=1)if(all[i].id==="SOLightBox"){resultSet.push(all[i]);if(resultSet.length>maxCount)break}style.removeRule(0);return resultSet};document.querySelectorAll=function(selector){return select(selector,Infinity)};document.querySelector=
function(selector){return select(selector,1)[0]||null}})()}SOE.prototype.getIEVersion=function(){var ieversion=999;if(navigator.appName=="Microsoft Internet Explorer"){var myNav=navigator.userAgent.toLowerCase();ieversion=myNav.indexOf("msie")!=-1?parseInt(myNav.split("msie")[1]):false}return ieversion};SOE.prototype.setButtonFrameToBottom=function(){var f=document.querySelectorAll("*[id*='SOLightBox']");for(var i=0;i<f.length;i++){var sibling=f[i].parentElement.children;var onclickProperty="soe.toggleLightBox('"+
f[i].id.replace("SOLightBox","")+"')";for(var j=0;j<sibling.length;j++)if(sibling[j].getAttribute("onclick")&&sibling[j].getAttribute("onclick")==onclickProperty){var child=sibling[j].querySelector("*[type='button']");if(child)child.style.backgroundImage="none";document.getElementsByTagName("body")[0].appendChild(f[i]);break}}};SOE.prototype.setIframeOnloadEvent=function(isNewFront,onLoadedframeId){var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe']");if(allIfrm.length>0)for(var i=
0;i<allIfrm.length;i++)if(isNewFront&&onLoadedframeId){if(allIfrm[i].id=="SOI_"+onLoadedframeId)onIframeLoad(allIfrm[i])}else{allIfrm[i].setAttribute("onload","onIframeLoad(this)");var innerIframe=allIfrm[i].contentDocument?allIfrm[i].contentDocument:allIfrm[i].contentWindow.document;var myIframe=innerIframe.getElementsByName("myFrame")[0];while(myIframe==null||myIframe=="undefined")setTimeout(function(){myIframe=innerIframe.getElementsByName("myFrame")[0]},33);myIframe.setAttribute("onload","parent.onIframeLoad(this)")}};
SOE.prototype.setIframeInitialView=function(){var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe']");if(allIfrm.length>0)for(var i=0;i<allIfrm.length;i++)if(allIfrm[i].parentNode.querySelectorAll("*[name='SOLoadingMessage']").length==0){allIfrm[i].style.display="none";var cssElem="",cssElemNew="",head=document.head||document.getElementsByTagName("head")[0],mCss=allIfrm[i].parentNode.offsetWidth<=540;cssElem="#SOLoadingMessage"+i+" img#loadingImage{display:none;visibility:hidden;}#SOLoadingMessage"+
i+" #circle{display:inline-block;vertical-align:top;}#SOLoadingMessage"+i+" .circle{background-color:#fff;float:left;"+(mCss?"height:9px;margin-right:11px;width:15px;":"height:10px;margin-right:20px;width:17px;")+"-webkit-animation-name:so_bounce_circle;-webkit-animation-duration:2s;-webkit-animation-iteration-count:infinite;-webkit-animation-direction:linear;-ms-animation-name:so_bounce_circle;-ms-animation-duration:2s;-ms-animation-iteration-count:infinite;-ms-animation-direction:linear;-moz-animation-name:so_bounce_circle;-moz-animation-duration:2s;-moz-animation-iteration-count:infinite;-moz-animation-direction:linear;-o-animation-name:so_bounce_circle;-o-animation-duration:2s;-o-animation-iteration-count:infinite;-o-animation-direction:linear;animation-name:so_bounce_circle;animation-duration:2s;animation-iteration-count:infinite;animation-direction:linear;opacity:0.3;-webkit-animation-fill-mode:backwards}/*@media only screen and (max-width:540px){SOLoadingMessage .circle{height:9px;margin-right:11px;width:15px;}}*/#SOLoadingMessage"+
i+" #circle_1{-webkit-animation-delay:.2s;-ms-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}#SOLoadingMessage"+i+" #circle_2{-webkit-animation-delay:.4s;-ms-animation-delay:.4s;-moz-animation-delay:.4s;-o-animation-delay:.4s;animation-delay:.4s}#SOLoadingMessage"+i+" #circle_3{-webkit-animation-delay:.6s;-ms-animation-delay:.6s;-moz-animation-delay:.6s;-o-animation-delay:.6s;animation-delay:.6s}#SOLoadingMessage"+i+" #circle_4{-webkit-animation-delay:.8s;-ms-animation-delay:.8s;-moz-animation-delay:.8s;-o-animation-delay:.8s;animation-delay:.8s}#SOLoadingMessage"+
i+" #circle_5{-webkit-animation-delay:1s;-ms-animation-delay:1s;-moz-animation-delay:1s;-o-animation-delay:1s;animation-delay:1s}#SOLoadingMessage"+i+" #circle_6{-webkit-animation-delay:1.2s;-ms-animation-delay:1.2s;-moz-animation-delay:1.2s;-o-animation-delay:1.2s;animation-delay:1.2s}#SOLoadingMessage"+i+" #circle_7{-webkit-animation-delay:1.4s;-ms-animation-delay:1.4s;-moz-animation-delay:1.4s;-o-animation-delay:1.4s;animation-delay:1.4s}#SOLoadingMessage"+i+" #circle_8{-webkit-animation-delay:1.6s;-ms-animation-delay:1.6s;-moz-animation-delay:1.6s;-o-animation-delay:1.6s;animation-delay:1.6s}#SOLoadingMessage"+
i+" #circle_9{-webkit-animation-delay:1.8s;-ms-animation-delay:1.8s;-moz-animation-delay:1.8s;-o-animation-delay:1.8s;animation-delay:1.8s}#SOLoadingMessage"+i+' #circle_10{-webkit-animation-delay:2s;-ms-animation-delay:2s;-moz-animation-delay:2s;-o-animation-delay:2s;animation-delay:2s}@-webkit-keyframes "so_bounce_circle"{0%{opacity:1;background-color:#a6a6a6;}25%{opacity:1;background-color:#a6a6a6;}50%{opacity:0.5;background-color:#a6a6a6;}75%{opacity:0.3;background-color:#a6a6a6;}100%{opacity:0.1;background-color:#a6a6a6;}}@-ms-keyframes so_bounce_circle{0% { opacity:1;background-color:#a6a6a6}25%{opacity:1;background-color:#a6a6a6}50%{opacity:0.5;background-color:#a6a6a6}75%{opacity:0.3;background-color:#a6a6a6}100%{opacity:0.1;background-color:#a6a6a6}}@-moz-keyframes so_bounce_circle{0%{opacity:1;background-color:#a6a6a6;}25%{opacity:1;background-color:#a6a6a6;}50%{opacity:0.5;background-color:#a6a6a6;}75%{opacity:0.3;background-color:#a6a6a6;}100%{opacity:0.1;background-color:#a6a6a6;}}@-o-keyframes so_bounce_circle{0%{opacity:1;background-color:#a6a6a6}25%{opacity:1;background-color:#a6a6a6}50%{opacity:0.5;background-color:#a6a6a6}75%{opacity:0.3;background-color:#a6a6a6}100%{opacity:0.1;background-color:#a6a6a6}}@keyframes "so_bounce_circle"{0%{opacity:1;background-color:#a6a6a6;}25%{opacity:1;background-color:#a6a6a6;}50%{opacity:0.5;background-color:#a6a6a6;}75%{opacity:0.3;background-color:#a6a6a6;}100%{opacity:0.1;background-color:#a6a6a6;}}';
cssElemNew="#BlueBox{position:relative;}.loaderOuter{font-family: 'Open Sans', sans-serif;max-width:260px;margin:0 auto 30px;position:absolute;left:50%;width:100%;top:50%;transform:translate(-50%,-100%)}.loaderOuter.loaderTop{margin-top:30px;margin-bottom:15px;position:static;transform:translate(0%,0%)}.loaderOuter .loaderLabel{text-align:center;margin-bottom:12px;font-size:1.4rem;font-weight:700;display:block;width:100%;float:left}.loaderOuter .loader{height:4px;width:100%;position:relative;overflow:hidden}.loaderOuter .loader span{height:100%;left:0;opacity:.6;position:absolute;right:0;width:100%;z-index:1}.loaderOuter .loader .innerLoader{display:block;position:absolute;z-index:2;left:-200px;width:200px;height:4px;animation:loading 2s linear infinite;-webkit-animation:loading 2s linear infinite;-moz-animation:loading 2s linear infinite;-o-animation:loading 2s linear infinite;-ms-animation:loading 2s linear infinite}.loaderOuter .loaderLabel{text-align:center;margin-bottom:12px;font-size:1.4rem;font-weight:700;display:block;width:100%;float:left}.CustomButtonColor {background-color: #0055aa;color: #FFF;}.loaderOuter .loader span {height: 100%;left: 0;opacity: 0.6;position: absolute;right: 0;width: 100%;z-index: 1;}@keyframes loading {from {left: -200px; width: 30%;}50% {width: 30%;}70% {width: 70%;}80% { left: 50%;}95% {left: 120%;}to {left: 100%;}}@-webkit-keyframes loading {from {left: -200px; width: 30%;}50% {width: 30%;}70% {width: 70%;}80% { left: 50%;}95% {left: 120%;}to {left: 100%;}}";
var style=document.createElement("style");style.type="text/css";if(style.styleSheet)style.styleSheet.cssText=cssElem;else{style.appendChild(document.createTextNode(cssElem));style.appendChild(document.createTextNode(cssElemNew))}head.appendChild(style);var loadingDiv='<div name="SOLoadingMessage" id="SOLoadingMessage'+i+'" style="box-sizing: border-box;min-height: 470px; margin: 0 auto;left: 0;right: 0; max-width: 796px; position: static; display: block; background-color: white;z-index: 100000000; width: 100%;">';
loadingDiv+='<div id="BlueBox" class="blueBox gradient" style="height: 356px; box-sizing: border-box; width: 100%; border-radius: 6px;"><div id="iframeContainer" class="whiteBox" style="  width: 100%; height: 100%; border-radius: 6px; min-width: 223px; box-sizing: content-box;  display: block;  background-color: #fff;"><div id="Navigation"></div></div></div></div></div></div></div>';allIfrm[i].parentNode.innerHTML=loadingDiv+allIfrm[i].parentNode.innerHTML}};SOE.prototype.renameDulplicateIframes=
function(){var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe']");var allDuplicateIframes=[];if(allIfrm.length>1)for(var i=0;i<allIfrm.length;i++){var iframes=document.querySelectorAll("[id='"+allIfrm[i].id+"']");if(iframes.length>1)var index=arrayContainsElement(allDuplicateIframes,allIfrm[i].id);else if(iframes.length==1&&allIfrm[i].name=="ScheduleOnceIframe")allIfrm[i].name=allIfrm[i].name+"_"+allIfrm[i].id.substring("SOI_".length);if(index>-1)allDuplicateIframes[index][1]=allDuplicateIframes[index][1]+
1;else allDuplicateIframes[allDuplicateIframes.length]=[allIfrm[i].id,1]}if(allDuplicateIframes.length>0)for(var i=0;i<allDuplicateIframes.length;i++){var sameDuplicates=document.querySelectorAll("[id='"+allDuplicateIframes[i][0]+"']");if(sameDuplicates.length>1)for(var j=0;j<sameDuplicates.length;j++){sameDuplicates[j].id=sameDuplicates[j].id+"_"+j;sameDuplicates[j].name="ScheduleOnceIframe"+"_"+sameDuplicates[j].id.substring("SOI_".length);var parent=sameDuplicates[j].parentNode;parent.removeChild(sameDuplicates[j]);
parent.appendChild(sameDuplicates[j])}}};if(window.addEventListener)window.addEventListener("message",receiveMessage,false);else if(window.attachEvent)window.attachEvent("onmessage",receiveMessage);else window.onmessage=receiveMessage;SOE.prototype.AddEventListners=function(link,embPageName,height,width,isParameterizedUrl,isSoSkip,isScrollableIframe){var isScrollableIframe=!!isScrollableIframe;soe.UpdateIframeSource(isParameterizedUrl,isSoSkip);soe.CheckAndEmbedIframeInDiv(link,embPageName,height,
width,isParameterizedUrl,isSoSkip,isScrollableIframe);var supportOrientation="onorientationchange"in window,orientationEvent=supportOrientation?"orientationchange":"resize";if(window.addEventListener)window.addEventListener(orientationEvent,soe.orientationChange,false);else if(window.attachEvent)window.attachEvent("on"+orientationEvent,soe.orientationChange);if(soe.isMobileView&&soe.isLive){var body=document.getElementsByTagName("body")[0];body.addEventListener("touchmove",function(evt){if(evt.touches.length>
1)soe.runCode=true;else soe.runCode=false});body.addEventListener("touchend",soe.zoomChange)}var f=document.querySelectorAll("[name*='ScheduleOnceIframe']");while(f==null||f=="undefined")setTimeout(function(){f=document.querySelectorAll("[name*='ScheduleOnceIframe']")},33);soe.renameDulplicateIframes();var style;for(var i=0;i<f.length;i++){try{if(f[i]&&f[i].scrolling==="no")f[i].height=soe.isMobileView?"100%":"auto"}catch(err){}style=f[i].getAttribute("style");style+="-webkit-box-sizing:border-box;box-sizing:border-box;-moz-box-sizing:border-box;";
if(document.getElementById)if(soe.isMobileView==null&&window.innerWidth<=767)soe.isMobileView=true;f[i].setAttribute("style",style);f[i].width="100%";f[i].style.width="100%";if(f[i]&&f[i].scrolling==="no")f[i].style.height=soe.isMobileView?"100%":"auto"}if(!soe.delayLoading)if(!checkDocumentLoaded())window.addEventListener("load",soe.setIframeSrc,false);else soe.setIframeSrc();soe.setSOBookingLink()};SOE.prototype.UpdateIframeSource=function(isParameterizedUrl,isSoSkip){var soqueryparam=soe.GetSFOrISParam(isParameterizedUrl,
isSoSkip);var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe']");if(allIfrm.length>0)for(var i=0;i<allIfrm.length;i++){var ifrmPrnt=allIfrm[i].parentNode;var maxW=this.getAttrPrms(ifrmPrnt,"data-style","max-width","796px");var minW=this.getAttrPrms(ifrmPrnt,"data-style","min-width","");this.setStyl(allIfrm[i],{"max-width":maxW,"min-width":minW});var prm=soe.getAttr(ifrmPrnt,"data-psz");if(prm&&prm[0]&&prm[1])soqueryparam=soe.GetSFOrISParam((prm[0]==="1").toString(),(prm[1]==="1").toString());
if(allIfrm[i].src.indexOf(soqueryparam)<0)if(allIfrm[i].src!=window.location.href)allIfrm[i].src=soe.updateIframeWithQueryParam(allIfrm[i].src.toLowerCase(),soqueryparam)}};SOE.prototype.updateIframeWithQueryParam=function(iframesrc,soqueryparam){if(iframesrc.indexOf("sosfleadid")>=0)iframesrc=iframesrc.replace(iframesrc.substring(iframesrc.indexOf("sosfleadid")-1),"");if(iframesrc.indexOf("sosfcontactid")>=0)iframesrc=iframesrc.replace(iframesrc.substring(iframesrc.indexOf("sosfcontactid")-1),"");
if(iframesrc.indexOf("sosfcaseid")>=0)iframesrc=iframesrc.replace(iframesrc.substring(iframesrc.indexOf("sosfcaseid")-1),"");if(iframesrc.indexOf("soiscontactId")>=0)iframesrc=iframesrc.replace(iframesrc.substring(iframesrc.indexOf("soiscontactId")-1),"");if(iframesrc.indexOf("soskip")>=0)iframesrc=iframesrc.replace(iframesrc.substring(iframesrc.indexOf("soskip")-1,iframesrc.indexOf("soskip")+8),"");return iframesrc+soqueryparam};SOE.prototype.GetSFOrISParam=function(isParameterizedUrlParam,isSoSkip){var soqueryparam=
"";if(typeof isParameterizedUrlParam!="undefined")isParameterizedUrl=isParameterizedUrlParam;if(typeof isSoSkip!="undefined")isSoSkipParam=isSoSkip;if(window.location.href.indexOf("?")>0){var queryparam=window.location.href.slice(window.location.href.indexOf("?")+1);var hashes=queryparam.split("&");queryparam=queryparam.toLowerCase();if(queryparam.indexOf("sosfleadid")>=0)for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="sosfleadid")soqueryparam+="&sosfleadid="+
hash[1]}if(queryparam.indexOf("sosfcontactid")>=0)for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="sosfcontactid")soqueryparam+="&sosfcontactid="+hash[1]}if(queryparam.indexOf("sosfcaseid")>=0)for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="sosfcaseid")soqueryparam+="&sosfcaseid="+hash[1]}else if(queryparam.indexOf("soiscontactid")>=0)for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="soiscontactid")soqueryparam+=
"&soiscontactId="+hash[1]}else if(queryparam.indexOf("inf_contact_key")>=0&&queryparam.indexOf("contactid")>=0)for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="contactid")soqueryparam+="&contactId="+hash[1]}var isSoSkipInQueryStr=false;for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(hash[0].toLowerCase()=="soskip"){soqueryparam+="&soskip="+hash[1];isSoSkipInQueryStr=true}}if(!isSoSkipInQueryStr&&typeof isSoSkipParam!="undefined")soqueryparam+="&soskip="+
(isSoSkipParam=="true"?"1":"0");if(!(typeof isParameterizedUrl==="undefined")&&isParameterizedUrl.toLowerCase()=="true")for(i=0;i<hashes.length;i++){hash=hashes[i].split("=");if(!(hash[0].toLowerCase()=="sosfleadid"||hash[0].toLowerCase()=="sosfcontactid"||hash[0].toLowerCase()=="sosfcaseid"||hash[0].toLowerCase()=="soiscontactid"||hash[0].toLowerCase()=="contactid"||hash[0].toLowerCase()=="soskip"||hash[0].toLowerCase()=="m"))soqueryparam+="&"+hashes[i]}}return soqueryparam};SOE.prototype.CheckAndEmbedIframeInDiv=
function(link,embPageName,height,width,isParameterizedUrl,isSoSkip,isScrollableIframe){var soqueryparam=soe.GetSFOrISParam(isParameterizedUrl,isSoSkip);if(typeof embPageName!="undefined"&&embPageName.length>0)pageName=embPageName;if(typeof pageName!="undefined"&&typeof pageName!=null&&pageName.length>0){var containerId="SOIDIV_"+pageName;try{var Ifrmcontainers=document.querySelectorAll('[id="'+containerId+'"]');if(Ifrmcontainers&&Ifrmcontainers.length>1)for(i=0;i<Ifrmcontainers.length;i++)soe.setIframeSource(Ifrmcontainers[i],
soqueryparam,link,pageName,height,width,isScrollableIframe);else{var Ifrmcontainer=document.getElementById(containerId);soe.setIframeSource(Ifrmcontainer,soqueryparam,link,pageName,height,width,isScrollableIframe)}}catch(ex){console.log(ex);var Ifrmcontainer=document.getElementById(containerId);soe.setIframeSource(Ifrmcontainer,soqueryparam,link,pageName,height,width,isScrollableIframe)}}};SOE.prototype.setIframeSource=function(Ifrmcontainer,soqueryparam,link,pageName,height,width,isScrollableIframe){var iframe=
Ifrmcontainer.getElementsByTagName("iframe");if(iframe.length==0)if(Ifrmcontainer!=null)Ifrmcontainer.innerHTML=soe.getIframeHTML(soqueryparam,link,pageName,height,width,isScrollableIframe)};SOE.prototype.getIframeHTML=function(soqueryparam,link,pageName,h,w,isScrollableIframe){if(typeof link!="undefined"&&typeof pageName!=undefined&&typeof h!=undefined&&typeof w!=undefined){ScheduleOnceEmbedLink=link;id="SOI_"+pageName;h=h;w=w}var style="width:"+w+";";var scrollingEnable="no";if(isScrollableIframe){h=
h?h.split("px")[0]-2+"px":"auto";scrollingEnable="yes";soqueryparam=soqueryparam+"&Si=1"}else style+="min-height:472px;";if(this.isMobileView){ScheduleOnceEmbedLink=ScheduleOnceEmbedLink.replace("&dt=","&dt=0");if(ScheduleOnceEmbedLink.indexOf("&m=true")<0&&ScheduleOnceEmbedLink.indexOf("&m=1")<0)ScheduleOnceEmbedLink+="&m=true"}var ifrmPrnt=document.getElementById("SOIDIV_"+pageName);var maxW=this.getAttrPrms(ifrmPrnt,"data-style","max-width","796px");var minW=this.getAttrPrms(ifrmPrnt,"data-style",
"min-width","");var code='<iframe src="'+ScheduleOnceEmbedLink+soqueryparam+'" id ="'+id+'" name="ScheduleOnceIframe"  scrolling="'+scrollingEnable+'" frameborder="0" hspace="0" marginheight="0" marginwidth="0" height="'+h+'" width="'+w+'" vspace="0" style="'+(minW!=""?"min-width: "+minW+"; ":"")+"max-width: "+maxW+";Margin: 0px auto;position:initial;"+style+'"></iframe>';return code};SOE.prototype.setIframeSrc=function(){var soqueryparam=soe.GetSFOrISParam();var allIfrm=document.querySelectorAll("[name*='ScheduleOnceIframe']");
if(allIfrm.length>0)for(var i=0;i<allIfrm.length;i++){var mysrc=allIfrm[i].getAttribute("data-mysrc");if(mysrc&&allIfrm[i].src.replace(/https?:/i,"")!=mysrc)allIfrm[i].src=mysrc+soqueryparam}};SOE.prototype.setSOBookingLink=function(){var soBookingLinks=document.getElementsByName("SOBookingLink");if(soBookingLinks.length>0)for(var j=0;j<soBookingLinks.length;j++)if(soBookingLinks[j]&&!soBookingLinks[j].hasAttribute("onclick")){var pageName=soBookingLinks[j].getAttribute("data-page")?soBookingLinks[j].getAttribute("data-page"):
"";soBookingLinks[j].setAttribute("onclick","soe.toggleLightBox('"+pageName+"')");var soBookingLinkXbutton=document.getElementById("SOIC_"+pageName);if(soBookingLinkXbutton&&!soBookingLinkXbutton.hasAttribute("onclick"))soBookingLinkXbutton.setAttribute("onclick","soe.toggleLightBox('"+pageName+"')")}};if(screen.width<768)soe.isMobileView=true;soe.setButtonFrameToBottom();SOE.prototype.SetBasicParam=function(ScheduleOnceEmbedLink,ScheduleOnceEmbedPageName,ScheduleOnceEmbedBookingBText,ScheduleOnceEmbedBookingBBGColor,
ScheduleOnceEmbedBookingBTextColor){soe.isMobileView=soe.isMobileView?soe.isMobileView:window.innerWidth<=767?true:false;soe.windowWidth=soe.windowWidth?soe.windowWidth:window.innerWidth;if(typeof ScheduleOnceEmbedLink!="undefined"&&ScheduleOnceEmbedLink&&typeof ScheduleOnceEmbedPageName!="undefined"){soe.link=ScheduleOnceEmbedLink;soe.pageName="'"+soe.decodeToHTML(ScheduleOnceEmbedPageName)+"'";soe.isWidget=true;try{soe.screenwidth_swh=window.innerWidth;soe.isNewPage=NewPage}catch(err){}soe.bookingBText=
ScheduleOnceEmbedBookingBText;soe.bookingBBGColor=ScheduleOnceEmbedBookingBBGColor;soe.bookingBTextColor=ScheduleOnceEmbedBookingBTextColor}};SOE.prototype.InitButton=function(ScheduleOnceEmbedLink,ScheduleOnceEmbedPageName,ScheduleOnceEmbedBookingBText,ScheduleOnceEmbedBookingBBGColor,ScheduleOnceEmbedBookingBTextColor,isParameterized,isScrollableIframe,height,queryParam){try{var isScrollableIframe=!!isScrollableIframe;soe.SetBasicParam(ScheduleOnceEmbedLink,ScheduleOnceEmbedPageName,ScheduleOnceEmbedBookingBText,
ScheduleOnceEmbedBookingBBGColor,ScheduleOnceEmbedBookingBTextColor);soe.setButtonHTML(isParameterized,isScrollableIframe&&height,height,true,queryParam)}catch(err){if(typeof console=="object")console.log(err)}};SOE.prototype.InitWidget=function(ScheduleOnceEmbedLink,ScheduleOnceEmbedPageName,ScheduleOnceEmbedBookingBText,ScheduleOnceEmbedBookingBBGColor,ScheduleOnceEmbedBookingBTextColor,ScheduleOnceEmbedPosition,ScheduleOnceEmbedPhoneTitle,ScheduleOnceEmbedPhoneText,ScheduleOnceEmbedEmailTitle,
ScheduleOnceEmbedEmailBText,ScheduleOnceEmbedEmailBTextColor,ScheduleOnceEmbedEmailBBGColor,ScheduleOnceEmbedEmailSendTo,ScheduleOnceEmbedEmailAck,ScheduleOnceEmbedEmailAfter,ScheduleOnceEmbedEmailCustTemp,ScheduleOnceEmbedEmailUserTemp,ScheduleOnceEmbedBookingTitle,ScheduleOnceEmbedWidgetTitle,ScheduleOnceEmbedWidgetColor,ScheduleOnceEmbedWidgetBGColor,ScheduleOnceEmbedWidgetLeft,ScheduleOnceEmbedAid,isScrollableIframe,widgetHeight,ScheduleOnceEmbedtargetUrl,queryParam){try{var isScrollableIframe=
!!isScrollableIframe&&widgetHeight;soe.SetBasicParam(ScheduleOnceEmbedLink,ScheduleOnceEmbedPageName,ScheduleOnceEmbedBookingBText,ScheduleOnceEmbedBookingBBGColor,ScheduleOnceEmbedBookingBTextColor);soe.bookingTitle=ScheduleOnceEmbedBookingTitle;soe.bookingPos=ScheduleOnceEmbedPosition.split(",")[0];soe.emailPos=ScheduleOnceEmbedPosition.split(",")[1];soe.phonePos=ScheduleOnceEmbedPosition.split(",")[2];soe.displayCount=soe.bookingPos<1?soe.displayCount-1:soe.displayCount;soe.displayCount=soe.phonePos<
1?soe.displayCount-1:soe.displayCount;soe.displayCount=soe.emailPos<1?soe.displayCount-1:soe.displayCount;soe.widgetTitle=ScheduleOnceEmbedWidgetTitle;soe.widgetColor=ScheduleOnceEmbedWidgetColor;soe.widgetBGColor=ScheduleOnceEmbedWidgetBGColor;soe.widgetLeft=ScheduleOnceEmbedWidgetLeft;soe.eaid=typeof ScheduleOnceEmbedAid=="undefined"?"":ScheduleOnceEmbedAid;soe.phoneTitle=ScheduleOnceEmbedPhoneTitle;soe.phoneText=ScheduleOnceEmbedPhoneText;soe.emailTitle=ScheduleOnceEmbedEmailTitle;soe.emailBText=
ScheduleOnceEmbedEmailBText;soe.emailBTextColor=ScheduleOnceEmbedEmailBTextColor;soe.emailBBGColor=ScheduleOnceEmbedEmailBBGColor;soe.emailSendTo=ScheduleOnceEmbedEmailSendTo;soe.emailAck=ScheduleOnceEmbedEmailAck;soe.emailAfter=ScheduleOnceEmbedEmailAfter;soe.emailCustTemplateId=typeof ScheduleOnceEmbedEmailCustTemp=="undefined"?0:ScheduleOnceEmbedEmailCustTemp;soe.emailUserTemplateId=typeof ScheduleOnceEmbedEmailUserTemp=="undefined"?0:ScheduleOnceEmbedEmailUserTemp;soe.targetUrl=ScheduleOnceEmbedtargetUrl;
soe.setWidgetHTML(isScrollableIframe,widgetHeight,queryParam);var fontLink=document.createElement("link");fontLink.href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700";fontLink.setAttribute("rel","stylesheet");document.head.appendChild(fontLink)}catch(err){if(typeof console=="object")console.log(err)}};MasterPageSOLightBox=function(_pageLink,pageName){var h="100%";var w="90%";var ver="";var style="border:solid 3px #FFF;background-color:#FFF;min-width:769px;min-height:472px;";var pre=
'<span id="SOIC_'+pageName.replace(/'/g,"")+'" onclick="soe.toggleLightBox(\''+pageName.replace(/'/g,"")+'\')" style="position: absolute; top: -1px; right: -23px; width: 16px; height: 16px; z-index: 1000; background-size: 74px 36px;background-repeat: no-repeat; background-position: -9px -8px; background-image: url('+soe.StaticURL+'/images/ncf_Lightbox@2x.png); background-color: transparent; cursor: pointer;"></span>';var post="";h="472px";w="100%";ver="";style="width:"+w+";height="+h+";"+style;var _code=
pre+'<iframe src="'+_pageLink+"&dt="+ver+'&em=1&Lightbox=1" id="SOI_'+pageName.replace(/'/g,"")+'" name="ScheduleOnceIframe"  scrolling="no" frameborder="0" hspace="0" marginheight="0" marginwidth="0" height="'+h+'" width="'+w+'" vspace="0" style="'+style+'"></iframe>'+post;return'<div id="SOLightBox'+pageName.replace(/'/g,"")+'" name="SOLightBox" style="top:-10000px; position:fixed; padding:0px; margin:0px;"><div id="SOInnerLightBox">'+_code+"</div></div>"};SOE.prototype.isIframePopupInViewport=
function(element,data,getPos){var dialogDetails=data.dialogDetails;var topOffset=element.offsetTop;var leftOffset=element.offsetLeft;var width=element.offsetWidth;var height=0;if(data.dialogDetails){topOffset+=dialogDetails.dialogOffsetTop;height=dialogDetails.dialogHeight}while(element.offsetParent){element=element.offsetParent;topOffset+=element.offsetTop;leftOffset+=element.offsetLeft}var isNotCutFromTop=topOffset>=window.pageYOffset;var isNotCutFromBottom=data.dialogDetails?topOffset+height<=
window.pageYOffset+window.innerHeight:true;var isNotCutFromLeft=leftOffset>=window.pageXOffset;var isNotCutFromRight=leftOffset+width<=window.pageXOffset+window.innerWidth;if(getPos)return!isNotCutFromTop?"top":!isNotCutFromBottom?"bottom":"";else return isNotCutFromTop&&isNotCutFromLeft&&isNotCutFromBottom&&isNotCutFromRight};SOE.prototype.setStyl=function(id,prop,val){try{var elm=typeof id==="string"?document.getElementById(id):id;if(elm&&elm.style)if(prop.constructor=={}.constructor)for(key in prop)try{var val=
typeof prop[key]=="number"?prop[key]+"px":prop[key];elm.style[key]=val}catch(err){console.log("setStyleSOMBD\n"+err)}else elm.style[prop]=val}catch(err$0){if(typeof console=="object")console.log("setStyleSOMBD\n"+err$0)}};SOE.prototype.getAttr=function(elm,attr,def){if(elm&&elm.tagName){var val=elm.getAttribute(attr);return val?val:def}else return def};SOE.prototype.getStyl=function(elm,styl,def){if(elm&&elm.style){var val=elm.style[styl];return val?val:def}else return def};SOE.prototype.getAttrPrms=
function(elm,attr,key,def){if(elm&&elm.tagName){var prm={};var val=elm.getAttribute(attr);if(val)val.split(";").forEach(function(e){var kv=e.split(":");if(kv.length>1)prm[kv[0].trim()]=kv[1].trim()});return key?prm[key]!=undefined?prm[key]:def:prm}else return def};SOE.prototype.setAttrPrms=function(elm,attr,kv){if(elm&&elm.tagName){var prm=this.getAttrPrms(elm,attr);var v="";for(p in prm){var chng=false;for(k in kv)if(k==p){v+=k+": "+kv[k]+"; ";chng=true;break}if(!chng)v+=p+": "+prm[p]+"; "}elm.setAttribute(attr,
v)}};try{soe.isMobileView=soe.isMobileView?soe.isMobileView:window.innerWidth<=767?true:false;soe.windowWidth=soe.windowWidth?soe.windowWidth:window.innerWidth;if(typeof ScheduleOnceEmbedLink!="undefined"&&ScheduleOnceEmbedLink&&typeof ScheduleOnceEmbedPageName!="undefined"){soe.link=ScheduleOnceEmbedLink;soe.pageName=soe.decodeToHTML(ScheduleOnceEmbedPageName);soe.isWidget=true;try{soe.screenwidth_swh=window.innerWidth;soe.isNewPage=NewPage}catch(err){}soe.bookingBText=ScheduleOnceEmbedBookingBText;
soe.bookingBBGColor=ScheduleOnceEmbedBookingBBGColor;soe.bookingBTextColor=ScheduleOnceEmbedBookingBTextColor;if(typeof ScheduleOnceEmbedPosition!="undefined"){soe.bookingTitle=ScheduleOnceEmbedBookingTitle;soe.bookingPos=ScheduleOnceEmbedPosition.split(",")[0];soe.emailPos=ScheduleOnceEmbedPosition.split(",")[1];soe.phonePos=ScheduleOnceEmbedPosition.split(",")[2];soe.displayCount=soe.bookingPos<1?soe.displayCount-1:soe.displayCount;soe.displayCount=soe.phonePos<1?soe.displayCount-1:soe.displayCount;
soe.displayCount=soe.emailPos<1?soe.displayCount-1:soe.displayCount;soe.widgetTitle=ScheduleOnceEmbedWidgetTitle;soe.widgetColor=ScheduleOnceEmbedWidgetColor;soe.widgetBGColor=ScheduleOnceEmbedWidgetBGColor;soe.widgetLeft=ScheduleOnceEmbedWidgetLeft;soe.eaid=typeof ScheduleOnceEmbedAid=="undefined"?"":ScheduleOnceEmbedAid;soe.phoneTitle=ScheduleOnceEmbedPhoneTitle;soe.phoneText=ScheduleOnceEmbedPhoneText;soe.emailTitle=ScheduleOnceEmbedEmailTitle;soe.emailBText=ScheduleOnceEmbedEmailBText;soe.emailBTextColor=
ScheduleOnceEmbedEmailBTextColor;soe.emailBBGColor=ScheduleOnceEmbedEmailBBGColor;soe.emailSendTo=ScheduleOnceEmbedEmailSendTo;soe.emailAck=ScheduleOnceEmbedEmailAck;soe.emailAfter=ScheduleOnceEmbedEmailAfter;soe.emailCustTemplateId=typeof ScheduleOnceEmbedEmailCustTemp=="undefined"?0:ScheduleOnceEmbedEmailCustTemp;soe.emailUserTemplateId=typeof ScheduleOnceEmbedEmailUserTemp=="undefined"?0:ScheduleOnceEmbedEmailUserTemp;soe.setWidgetHTML(true,"580px")}else soe.setButtonHTML()}}catch(err$1){if(typeof console==
"object")console.log(err$1)}};
